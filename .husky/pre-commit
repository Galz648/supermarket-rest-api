#!/usr/bin/env sh

# Check if the server is already running and responding
echo "Checking if the server is running and responding..."
if ! curl -s http://localhost:3000 > /dev/null; then
  echo "Error: Server is not running or not responding at http://localhost:3000"
  echo "Please start the server with 'bun run backend:dev' before committing"
  exit 1
fi

echo "Server is running and responding, proceeding with hooks..."

# Run the OpenAPI types generation script
sh "$(dirname -- "$0")/generate-openapi.sh"

# Run the Prisma client generation script
sh "$(dirname -- "$0")/generate-prisma.sh" 

# Run the consumer-backend client generation script
sh "$(dirname -- "$0")/generate-consumer-backend-client.sh"
